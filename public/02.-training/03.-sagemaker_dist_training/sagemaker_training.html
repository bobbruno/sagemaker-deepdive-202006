<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="SageMaker Deep Dive" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="generator" content="Hugo 0.72.0" />
  <meta name="description" content="SageMaker Deep Dive">
<meta name="author" content="Roberto Bruno Martins">

  <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

  <title>SageMaker distributed training :: SageMaker Deep Dive</title>

  
  <link href="../../css/nucleus.css" rel="stylesheet">
  <link href="../../css/fontawesome-all.min.css" rel="stylesheet">
  <link href="../../css/hybrid.css" rel="stylesheet">
  <link href="../../css/featherlight.min.css" rel="stylesheet">
  <link href="../../css/perfect-scrollbar.min.css" rel="stylesheet">
  <link href="../../css/auto-complete.css" rel="stylesheet">
  <link href="../../css/atom-one-dark-reasonable.css" rel="stylesheet">
  <link href="../../css/theme.css" rel="stylesheet">
  <link href="../../css/hugo-theme.css" rel="stylesheet">
  
  <link href="../../css/theme-aws.css" rel="stylesheet">
  

  <script src="../../js/jquery-3.3.1.min.js"></script>

  <style>
    :root #header + #content > #left > #rlblock_left{
        display:none !important;
    }
    
      :not(pre) > code + span.copy-to-clipboard {
          display: none;
      }
    
  </style>
  
</head>

<body class="" data-url="/02.-training/03.-sagemaker_dist_training/sagemaker_training.html">
  <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div>
    <a href="../../" title="Go home">
        <img style="vertical-align:middle" src="../../images/logo.png" height="70px" />
    </a>
</div>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js"></script>
<script type="text/javascript" src="../../js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../../js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/00.-setup.html" title="SageMaker Deep Dive" class="dd-item 
        
        
        
        ">
      <a href="../../00.-setup.html">
          Initial Setup
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/01.-intro.html" title="Introduction to Distributed Training" class="dd-item 
        
        
        
        ">
      <a href="../../01.-intro.html">
          Distributed Training Intro
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/01.-intro/01.-challenges.html" title="Challenges with scaling machine learning" class="dd-item ">
        <a href="../../01.-intro/01.-challenges.html">
        Challenges with scaling machine learning
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/01.-intro/02.-addressing_challenges.html" title="Addressing scaling challenges - software dependencies" class="dd-item ">
        <a href="../../01.-intro/02.-addressing_challenges.html">
        Addressing scaling challenges - software dependencies
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/01.-intro/03.-addressing_challenges-1.html" title="Addressing scaling challenges - Infrastructure management" class="dd-item ">
        <a href="../../01.-intro/03.-addressing_challenges-1.html">
        Addressing scaling challenges - Infrastructure management
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/01.-intro/04.-horovod.html" title="Distributed training approaches" class="dd-item ">
        <a href="../../01.-intro/04.-horovod.html">
        Distributed training approaches
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/02.-training.html" title="Distributed Training on SageMaker" class="dd-item 
        parent
        
        
        ">
      <a href="../../02.-training.html">
          Distributed Training
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/02.-training/01.-setup.html" title="Training Setup" class="dd-item 
        
        
        
        ">
      <a href="../../02.-training/01.-setup.html">
          Training Setup
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/02.-training/01.-setup/sm_jupyter_instance.html" title="Launch a SageMaker notebook instance" class="dd-item ">
        <a href="../../02.-training/01.-setup/sm_jupyter_instance.html">
        Launch a SageMaker notebook instance
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/01.-setup/download_workshop.html" title="Download the workshop content" class="dd-item ">
        <a href="../../02.-training/01.-setup/download_workshop.html">
        Download the workshop content
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/02.-training/02.-single_instance_training.html" title="Prepare your training scripts" class="dd-item 
        
        
        
        ">
      <a href="../../02.-training/02.-single_instance_training.html">
          Script preparation
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/02.-training/02.-single_instance_training/problem_setup.html" title="Problem statement" class="dd-item ">
        <a href="../../02.-training/02.-single_instance_training/problem_setup.html">
        Problem statement
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/02.-single_instance_training/prepare_dataset.html" title="Prepare training dataset" class="dd-item ">
        <a href="../../02.-training/02.-single_instance_training/prepare_dataset.html">
        Prepare training dataset
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/02.-single_instance_training/single_instance_script.html" title="Getting familiar with a single instance training script" class="dd-item ">
        <a href="../../02.-training/02.-single_instance_training/single_instance_script.html">
        Single instance script
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/02.-single_instance_training/distributed_training_script.html" title="Converting the script for Horovod API distributed training" class="dd-item ">
        <a href="../../02.-training/02.-single_instance_training/distributed_training_script.html">
        Horovod distributed training prep
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/02.-training/03.-sagemaker_dist_training.html" title="Distributed Training with Amazon Sagemaker" class="dd-item 
        parent
        
        
        ">
      <a href="../../02.-training/03.-sagemaker_dist_training.html">
          Distributed Training
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/02.-training/03.-sagemaker_dist_training/workflow.html" title="Workflow" class="dd-item ">
        <a href="../../02.-training/03.-sagemaker_dist_training/workflow.html">
        Workflow
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/03.-sagemaker_dist_training/training_scrip_updates.html" title="Updates required to run on SageMaker" class="dd-item ">
        <a href="../../02.-training/03.-sagemaker_dist_training/training_scrip_updates.html">
        Updates required to run on SageMaker
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/03.-sagemaker_dist_training/sagemaker_training.html" title="SageMaker distributed training" class="dd-item active">
        <a href="../../02.-training/03.-sagemaker_dist_training/sagemaker_training.html">
        SageMaker distributed training
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/02.-training/03.-sagemaker_dist_training/monitoring_results.html" title="Monitoring training progress" class="dd-item ">
        <a href="../../02.-training/03.-sagemaker_dist_training/monitoring_results.html">
        Monitoring training progress
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/03.-other-training.html" title="Other Training Features in SageMaker" class="dd-item 
        
        
        
        ">
      <a href="../../03.-other-training.html">
          Other Training Features
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/03.-other-training/01.-spot.html" title="Spot training lab" class="dd-item 
        
        
        
        ">
      <a href="../../03.-other-training/01.-spot.html">
          Spot training
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/03.-other-training/02.-debugger.html" title="SageMaker Debugger lab" class="dd-item 
        
        
        
        ">
      <a href="../../03.-other-training/02.-debugger.html">
          Debugger
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/03.-other-training/03.-experiments.html" title="SageMaker Experiments lab" class="dd-item 
        
        
        
        ">
      <a href="../../03.-other-training/03.-experiments.html">
          Experiments
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/03.-other-training/04.-hpo.html" title="Automatic Model Tuning" class="dd-item 
        
        
        
        ">
      <a href="../../03.-other-training/04.-hpo.html">
          HPO/Model Tuning
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/04.-ml-pipelines.html" title="Machine Learning Pipelines" class="dd-item 
        
        
        
        ">
      <a href="../../04.-ml-pipelines.html">
          ML Pipelines
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/04.-ml-pipelines/01.-processing-jobs.html" title="Processing Jobs" class="dd-item 
        
        
        
        ">
      <a href="../../04.-ml-pipelines/01.-processing-jobs.html">
          Processing Jobs
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/04.-ml-pipelines/01.-processing-jobs/01.-preprocess_spark.html" title="Processing with Spark" class="dd-item ">
        <a href="../../04.-ml-pipelines/01.-processing-jobs/01.-preprocess_spark.html">
        Processing with Spark
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/04.-ml-pipelines/01.-processing-jobs/02.-preprocess_dask.html" title="Processing with Dask" class="dd-item ">
        <a href="../../04.-ml-pipelines/01.-processing-jobs/02.-preprocess_dask.html">
        Processing with Dask
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/04.-ml-pipelines/02.-step-functions.html" title="Step Funcions and the DS SDK" class="dd-item 
        
        
        
        ">
      <a href="../../04.-ml-pipelines/02.-step-functions.html">
          Step Functions
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/05.-deployment.html" title="Deployment" class="dd-item 
        
        
        
        ">
      <a href="../../05.-deployment.html">
          Deployment
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/05.-deployment/01.-inference-pipelines.html" title="Inference Pipelines and Batch Transformations lab" class="dd-item 
        
        
        
        ">
      <a href="../../05.-deployment/01.-inference-pipelines.html">
          Inference Pipelines
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/05.-deployment/02.-elastic-inference.html" title="Elastic Inference Lab" class="dd-item 
        
        
        
        ">
      <a href="../../05.-deployment/02.-elastic-inference.html">
          Elastic Inference
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://twitter.com/bobbruno70"><i class='fab fa-twitter fa-lg'></i> @bobbruno70</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <left>

    <h5 class="copyright">&copy; 2020 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>

</left>

    </section>
  </div>
</nav>





  <section id="body">
    <div id="overlay"></div>
    <div class="padding highlightable">
      
      <div>
        <div id="top-bar">
          
          
          <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            
            <span class="links">
              
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <a href='../../'>SageMaker Deep Dive for Adidas</a> > <a href='../../02.-training.html'>Distributed Training on SageMaker</a> > <a href='../../02.-training/03.-sagemaker_dist_training.html'>Distributed Training with Amazon Sagemaker</a> > SageMaker distributed training
          
          
          
          
          
          
          
          
            </span>
          </div>
          
          <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#distributed-training-with-amazon-sagemaker">Distributed training with Amazon SageMaker</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

          
        </div>
      </div>
      

      
        <div id="body-inner">
          <h1>SageMaker distributed training</h1>
          
          




<p><br> Open <code>cifar10-sagemaker-distributed.ipynb</code> and run through the cells. The following notebook is located at: <br>
<strong><em>distributed-training-workshop &gt; notebooks &gt; part-2-sagemaker &gt; cifar10-sagemaker-distributed.ipynb</em></strong></p>

<p><img src="../../images/sagemaker/sm_notebook.png" alt="sm_notebook" /></p>


<div class="notices warning" ><p><strong>Stop:</strong> Do this section on JupyterLab. Below is a copy of the jupyter notebook for reference. <br></p>
</div>


<hr />

<h2 id="distributed-training-with-amazon-sagemaker">Distributed training with Amazon SageMaker</h2>

<p>In this notebook we use the SageMaker Python SDK to setup and run a distributed training job.
SageMaker makes it easy to train models across a cluster containing a large number of machines, without having to explicitly manage those resources.</p>

<p><strong>Step 1:</strong> Import essentials packages, start a sagemaker session and specify the bucket name you created in the pre-requsites section of this workshop.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> time
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> sagemaker

sagemaker_session <span style="color:#f92672">=</span> sagemaker<span style="color:#f92672">.</span>Session()
role <span style="color:#f92672">=</span> sagemaker<span style="color:#f92672">.</span>get_execution_role()
bucket_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;tfworld2019-&lt;your_bucket_name&gt;&#39;</span></code></pre></div>
<p><strong>Step 2:</strong> Specify hyperparameters, instance type and number of instances to distribute training to. The <code>hvd_processes_per_host</code> corrosponds to number of GPUs per instances.
For example, if you choose:</p>
<pre><code>hvd_instance_type = &#39;ml.p3.8xlarge&#39;
hvd_instance_count = 2
hvd_processes_per_host = 4</code></pre>
<p>Since p3.8xlarge instance has 4 GPUs, we&rsquo;ll we distributing training to 8 workers, 1 per GPU.
This is spread across 2 instances (or nodes). SageMaker automatically takes care of spinning up these instances and making sure they can communiate with each other.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hyperparameters <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;epochs&#39;</span>: <span style="color:#ae81ff">100</span>,
                   <span style="color:#e6db74">&#39;learning-rate&#39;</span>: <span style="color:#ae81ff">0.001</span>,
                   <span style="color:#e6db74">&#39;momentum&#39;</span>: <span style="color:#ae81ff">0.9</span>,
                   <span style="color:#e6db74">&#39;weight-decay&#39;</span>: <span style="color:#ae81ff">2e-4</span>,
                   <span style="color:#e6db74">&#39;optimizer&#39;</span>: <span style="color:#e6db74">&#39;adam&#39;</span>,
                   <span style="color:#e6db74">&#39;batch-size&#39;</span> : <span style="color:#ae81ff">256</span>}

hvd_instance_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ml.c5.xlarge&#39;</span>
hvd_instance_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
hvd_processes_per_host <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Distributed training with a total of {} workers&#39;</span><span style="color:#f92672">.</span>format(hvd_processes_per_host<span style="color:#f92672">*</span>hvd_instance_count))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{} x {} instances with {} processes per instance&#39;</span><span style="color:#f92672">.</span>format(hvd_instance_count, hvd_instance_type, hvd_processes_per_host))</code></pre></div>
<p><strong>Step 3:</strong> In this cell we create a SageMaker estimator, by providing it with all the information it needs to launch instances and execute training on those instances.</p>

<p>Since we&rsquo;re using horovod for distributed training, we specify <code>distributions</code> to mpi which is used by horovod.</p>

<p>In the TensorFlow estimator call, we specify training script under <code>entry_point</code> and dependencies under <code>source_dir</code>. SageMaker automatically copies these files into a TensorFlow container behind the scenes, and are executed on the training instances.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sagemaker.tensorflow <span style="color:#f92672">import</span> TensorFlow

output_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s3://{}/&#39;</span><span style="color:#f92672">.</span>format(bucket_name)
job_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sm-dist-{}x{}-workers&#39;</span><span style="color:#f92672">.</span>format(hvd_instance_count, hvd_processes_per_host) <span style="color:#f92672">+</span> time<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">-%H-%M-%S-%j&#39;</span>, time<span style="color:#f92672">.</span>gmtime())
model_dir <span style="color:#f92672">=</span> output_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;tensorboard_logs/&#39;</span> <span style="color:#f92672">+</span> job_name

distributions <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;mpi&#39;</span>: {
                    <span style="color:#e6db74">&#39;enabled&#39;</span>: True,
                    <span style="color:#e6db74">&#39;processes_per_host&#39;</span>: hvd_processes_per_host,
                    <span style="color:#e6db74">&#39;custom_mpi_options&#39;</span>: <span style="color:#e6db74">&#39;-verbose --NCCL_DEBUG=INFO -x OMPI_MCA_btl_vader_single_copy_mechanism=none&#39;</span>
                        }
                }

estimator_hvd <span style="color:#f92672">=</span> TensorFlow(base_job_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hvd-cifar10-tf&#39;</span>,
                       source_dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;code&#39;</span>,
                       entry_point<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cifar10-multi-gpu-horovod-sagemaker.py&#39;</span>,
                       role<span style="color:#f92672">=</span>role,
                       framework_version<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1.14&#39;</span>,
                       py_version<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;py3&#39;</span>,
                       hyperparameters<span style="color:#f92672">=</span>hyperparameters,
                       train_instance_count<span style="color:#f92672">=</span>hvd_instance_count,
                       train_instance_type<span style="color:#f92672">=</span>hvd_instance_type,
                       output_path<span style="color:#f92672">=</span>output_path,
                       model_dir<span style="color:#f92672">=</span>model_dir,
                       tags <span style="color:#f92672">=</span> [{<span style="color:#e6db74">&#39;Key&#39;</span> : <span style="color:#e6db74">&#39;Project&#39;</span>, <span style="color:#e6db74">&#39;Value&#39;</span> : <span style="color:#e6db74">&#39;cifar10&#39;</span>},{<span style="color:#e6db74">&#39;Key&#39;</span> : <span style="color:#e6db74">&#39;TensorBoard&#39;</span>, <span style="color:#e6db74">&#39;Value&#39;</span> : <span style="color:#e6db74">&#39;dist&#39;</span>}],
                       metric_definitions<span style="color:#f92672">=</span>[{<span style="color:#e6db74">&#39;Name&#39;</span>: <span style="color:#e6db74">&#39;val_acc&#39;</span>, <span style="color:#e6db74">&#39;Regex&#39;</span>: <span style="color:#e6db74">&#39;val_acc: ([0-9</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">.]+)&#39;</span>}],
                       distributions<span style="color:#f92672">=</span>distributions)</code></pre></div>
<p><strong>Step 4:</strong> Specify dataset locations in Amazon S3 and then call the fit function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s3://{}/cifar10-dataset/train&#39;</span><span style="color:#f92672">.</span>format(bucket_name)
val_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s3://{}/cifar10-dataset/validation&#39;</span><span style="color:#f92672">.</span>format(bucket_name)
eval_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s3://{}/cifar10-dataset/eval/&#39;</span><span style="color:#f92672">.</span>format(bucket_name)

estimator_hvd<span style="color:#f92672">.</span>fit({<span style="color:#e6db74">&#39;train&#39;</span>: train_path,<span style="color:#e6db74">&#39;validation&#39;</span>: val_path,<span style="color:#e6db74">&#39;eval&#39;</span>: eval_path},
                  job_name<span style="color:#f92672">=</span>job_name, wait<span style="color:#f92672">=</span>False)</code></pre></div>
<p><strong>Step 5:</strong> Monitor progress on TensorBoard. Launch tensorboard and open the link on a new tab to visualize training progress, and navigate to the following link</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">!</span>S3_REGION<span style="color:#f92672">=</span>us<span style="color:#f92672">-</span>east<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> tensorboard <span style="color:#f92672">--</span>logdir s3:<span style="color:#f92672">//</span>{bucket_name}<span style="color:#f92672">/</span>tensorboard_logs<span style="color:#f92672">/</span></code></pre></div>
<p>Open a new browser window/tab and navigate to the folloiwng link to access TensorBoard:
<br> <a href="https://adidas202006.notebook.us-east-1.sagemaker.aws/proxy/6006/" target="_blank">https://adidas202006.notebook.us-east-1.sagemaker.aws/proxy/6006/</a>
<br> Make sure that the name of the notebook instance is correct in the link above.
<br> Don&rsquo;t forget the slash at the end of the URL 6006/</p>


<div class="notices info" ><p>You can get the link to the tensorboard proxy with the following code. Just replace <code>nb-instance-name</code> with the name of the notebook instance you created:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> IPython.core.display <span style="color:#f92672">import</span> display, HTML
 
tb_url <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{sm.create_presigned_notebook_instance_url(NotebookInstanceName=&#39;nb-instance-name&#39;)[&#39;AuthorizedUrl&#39;].split(&#39;?&#39;)[0]}/proxy/6006/&#34;</span>
 
display(HTML(f<span style="color:#e6db74">&#34;&lt;a href=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">{tb_url}</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">  target=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">_blank</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&gt;Click here for Tensorboard&lt;/a&gt;&#34;</span>))</code></pre></div></div>



<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="../../02.-training/03.-sagemaker_dist_training/training_scrip_updates.html" title="Updates required to run on SageMaker"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../02.-training/03.-sagemaker_dist_training/monitoring_results.html" title="Monitoring training progress" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js"></script>
    <script src="../../js/perfect-scrollbar.min.js"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js"></script>
    <script src="../../js/jquery.sticky.js"></script>
    <script src="../../js/featherlight.min.js"></script>
    <script src="../../js/html5shiv-printshiv.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js"></script>
    <script src="../../js/learn.js"></script>
    <script src="../../js/hugo-learn.js"></script>

    <link href="../../mermaid/mermaid.css" rel="stylesheet" />
    <script src="../../mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <div id = 'kinesisStreamName' title = ""/></div>
<div id = 'cognitoPoolId' title = ""/></div>
<div id = 'awsRegion' title = ""/></div>
<div id = 'contentId' title = ""/></div>
<div id = 'language' title = "en"/></div>
<div id = 'versions' title = ""/></div>

<script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
<script src="../../js/kinesis.js"></script>
  </body>
</html>

